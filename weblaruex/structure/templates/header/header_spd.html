{% load static %}


<input id="hamburger" class="hamburger" type="checkbox" />
<label for="hamburger" class="hamburger">
    <i></i>
    <text>
        <close>menu</close>
        <open>menu</open>
    </text>
</label>
<nav class="primnav" id="primnav">
    <ul>
        <li>
            <a href="{% url 'spd:HomeSpida' %}" class="menu">
                <i class="fas fa-home fa-lg iconMenu"></i> Inicio
                <span class="tooltip">INICIO</span>
            </a>

            <ul class="secnav">
                <li>
                    <a href="{% url 'spd:HomeSpida' %}#defspida" class="submenu">¿Qué es
                        Spida?</a>
                </li>
                <li>
                    <a href="{% url 'spd:HomeSpida' %}#defenmarcacion" class="submenu">¿Donde se enmarca?</a>
                </li>
                <li>
                    <a href="{% url 'spd:HomeSpida' %}#defestaciones" class="submenu">Estaciones Spida</a>
                </li>
                <li>
                    <a href="{% url 'spd:HomeSpida' %}#defredesinfo" class="submenu">Redes de Información</a>
                </li>
                <li>
                    <a href="{% url 'spd:HomeSpida' %}#defobjetivo" class="submenu">Objetivo de Aplicación</a>
                </li>
                <li>
                    <a href="{% url 'spd:HomeSpida' %}#avisos" class="submenu">Sistema Inteligente</a>
                </li>
                <li>
                    <a href="{% url 'spd:HomeSpida' %}#contacto" class="submenu">Contacto</a>
                </li>
            </ul>
        </li>
        <li>
            <a href="{% url 'spd:MapaSpida' %}" class="menu">
                <i class="fas fa-map-marked-alt fa-lg iconMenu"></i> Datos en tiempo real
                <span class="tooltip">DATOS EN TIEMPO REAL</span>
            </a>
        </li>
        <li>
            <a href="{% url 'spd:SucesosSpida' %}" class="menu">
                <i class="fas fa-tint fa-lg iconMenu"></i> Sucesos
                <span class="tooltip">SUCESOS</span>
            </a>
        </li>
        <li>
            {% if user.is_authenticated %}
            {% if perms.auth.spida_alerta2 %}
            <a href="{% url 'spd:Alerta2' %}" class="menu"
                style="font-size: 15px; text-transform: lowercase; line-height: 20px; text-align: center; ">
                <!--<span class="iconMenu text-alerta2" style="font-size: 21px;line-height: 15px;">a<span
                        style="font-size: 24px;">2
                </span></span>-->
                <span class="iconMenu text-alerta2" style="font-size: 22px; letter-spacing: 1px;">a<span
                        style="font-size: 25px; top: 2.5px;">2</span></span>
                <span class="text-alerta2" style="font-size: 22px;">alerta<span
                        style="font-size: 25px;">2</span></span>
                <span class="tooltip" style="text-transform: lowercase;">
                    <span class="text-alerta2" style="font-size: 18px;">alerta<span
                            style="font-size: 21px;">2</span></span>
                </span>
            </a>
            <ul class="secnav">
                <li>
                    <a href="{% url 'spd:GraficosNivelRio' %}" class="submenu">Gráficos Nivel de Río</a>
                </li>
            </ul>
            {% endif %}
            {% endif %}

        </li>
        <li>
            {% if user.is_authenticated %}
            {% if perms.auth.spida_documentacion %}
            <a href="{% url 'spd:DocumentacionSpida' %}" class="menu">
                <i class="fas fa-folder-open fa-lg iconMenu"></i> Documentación
                <span class="tooltip">DOCUMENTACIÓN</span>
            </a>
            <ul class="secnav">
                {% if perms.auth.spida_inf_trimestrales %}
                <li>
                    <a href="{% url 'spd:InformesTrimestralesSpida' %}" class="submenu">Informes Trimestrales</a>
                </li>
                {% endif %}
                {% if perms.auth.spida_protocolo %}
                <li>
                    <a href="{% url 'spd:ViewProtocolo' %}" class="submenu">Protocolo de Actuación</a>
                </li>
                {% endif %}
                {% if perms.auth.spida_eventos %}
                <li>
                    <a href="{% url 'spd:EventosInundacion' %}" class="submenu">Eventos de Inundación</a>
                </li>
                {% endif %}
                {% if perms.auth.spida_alerta2 %}
                <!-- Si el usuario es de Alerta2 ... -->
                <li>
                    <a href="{% url 'spd:Contactos' %}" class="submenu">Teléfonos de Contacto</a>
                </li>
                {% endif %}
            </ul>
            {% endif %}
            {% endif %}

        </li>
        <li>
            {% if user.is_authenticated %}
            <a href="{% url 'structure:logout' %}?next={% url 'spd:LoginSpida' %}?next={% url 'spd:MapaSpida' %}"
                class="menu">
                <i class="fas fa-power-off fa-lg iconAcces"></i> Cerrar sesión
                <span class="tooltip">Cerrar sesión</span>
            </a>
            {% else %}
            <a href="{% url 'spd:LoginSpida' %}?next={% url 'spd:MapaSpida' %}" class="menu">
                <i class="fa fa-user fa-lg iconAcces fa-fade"></i> Acceso
                <span class="tooltip">Iniciar sesión</span>
            </a>
            {% endif %}
        </li>
    </ul>
</nav>


<nav class="navbar navbar-expand-custom navbar-dark encabezado" style="background-color: #1B1C1C;">
    <a class="navbar-brand" href="#" style="font-family: 'Alkeyboard';">SPIDA</a>
    {% if user.is_authenticated %}
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
        aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-user-cog"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <user>
            <section>
                <img id="ImageUser" src="../../../../media/profile/default.png" style="object-fit: cover;" onclick="viewAvatar(this.src)" />
                <section>
                    <name>{{user.get_full_name}}</name>
                    <actions><a href="{% url 'spd:PerfilSpida' %}"><i class="fas fa-cog"
                                style="padding-right: 4px;"></i>Configuración</a> | <a
                            href="{% url 'structure:logout' %}?next={% url 'spd:LoginSpida' %}?next={% url 'spd:MapaSpida' %}"><i
                                class="fas fa-power-off" style="padding-right: 4px;"></i>Cerrar sesión </a></actions>
                </section>
            </section>
        </user>
    </div>
    {% endif %}
</nav>

<script>
    function viewAvatar(path) {
        Swal.fire({
            imageUrl: path,
            showConfirmButton: false
        })
    }


    var photoavatar = "{{ user.profile.image.url }}" //Foto
    if (photoavatar != "") {
        $('#ImageUser').attr("src", photoavatar);
    }
</script>

<script>
    $(".primnav li a.submenu").on("click", function () {
        $(this).parent().parent().parent().find('a[class="menu"]').addClass('active')
    });

    $(".primnav li a.menu").on("click", function () {
        $(this).addClass('active');/*.siblings().removeClass('active');*/
    });

    $(document).ready(function () {
        if ($('.primnav li a[href$="' + location.pathname + '"]').hasClass('menu')) {
            $('.primnav li a[href$="' + location.pathname + '"]').addClass('active');
        }
        else if ($('.primnav li a[href$="' + location.pathname + '"]').hasClass('submenu')) {
            $('.primnav li a[href$="' + location.pathname + '"]').parent().parent().parent().find('a[class="menu"]').addClass("active")
        }
    });


    /*Para que cuando hago click sobre los submenus se esconda el menu navbar*/
    const navLinks = document.querySelectorAll('.submenu')
    const menuToggle = document.getElementById('primnav')
    const bsCollapse = new bootstrap.Collapse(menuToggle, { toggle: false })
    navLinks.forEach((l) => {
        l.addEventListener('click', () => { $("#hamburger").click(); })
    })
</script>

{% extends "base/base_timetrackpro.html" %}
{% load static %}
{% block content %}
{% if relUser %}
<div class="row">
  <div class="col">
    <h4 class="mb-2">
      {{relUser.id_usuario.nombre}} {{relUser.id_usuario.apellidos}}
    </h4>


    {% if usuarioMaquina.en_practicas == 1 %}
    <span class="badge badge-xs bg-gradient-info mb-2">En prácticas</span>
    {% else %}
    <span class="badge badge-xs bg-gradient-dark mb-2">Empleado</span>
    {% endif %}
    

    <p class="text-md">Acontinuación se muestran los datos de {{relUser.id_usuario.nombre}} {{relUser.id_usuario.apellidos}} con los que se han configurado las máquinas de control de asistencia, instaladas para el control de asistencia en Laruex.</p>

  </div>   
</div>
{% endif %}
  <div class="row d-flex justify-content-center">
    <div class="col-12 col-xl-4 d-flex align-items-center">
        <div class="d-block shadow-xl border-radius-xl">
          <img src="{% static 'img/timetrackpro/control-huella.jpeg' %}" alt="img-blur-shadow" class="img-fluid shadow border-radius-xl h-75">
        </div>
    </div>
    <div class="col-12 col-xl-4">
      {% if administrador %}
        <div class="pb-0 p-3 d-flex justify-content-end mb-4" style="background-color: transparent;">
          <div class="row">
            <div class="col">
             <button class="botonLink" data-toggle="modal" data-target="#modalEditarUsuarioMaquina">             
              <div class="sign-Btn-link"><i class="fa-solid fa-pen fa-lg" style="color: #ffffff;"></i></div>
              <div class="text text-sm">Editar usuario</div>
            </button>
            </div>
          </div>
        </div>
      {% endif %}
        

      <div class="card ">
        <div class="card-header pb-0 p-3">
          <div class="row">
            <div class="col">
              <h5 class="mb-2">
                Datos registrados  
              </h5>

            </div>
                
            {% if usuarioMaquina.admin_dispositivo == 1 %}
            <div class="col d-flex justify-content-end">
              <span class="badge badge-xxs bg-gradient-info mb-2">Admin</span>
            </div>
            {% endif %}

          </div>
        </div>
        
        <div class="card-body pt-0 p-3" >
            <ul class="list-group">

              <li class="list-group-item border-0 ps-0 pt-0 text-sm"><strong class="text-dark">Nombre:</strong> &nbsp;{{usuarioMaquina.nombre}}</li>
              <li class="list-group-item border-0 ps-0 pt-0 text-sm"><strong class="text-dark">ID:</strong> &nbsp;{{usuarioMaquina.id}}</li>
              
              <li class="list-group-item border-0 ps-0 pt-0 text-sm"><strong class="text-dark">Turno:</strong> &nbsp;{% if usuarioMaquina.turno %}{{usuarioMaquina.turno}} {% else %} Sin asignar{% endif %} </li>

              <li class="list-group-item border-0 ps-0 pt-0 text-sm"><strong class="text-dark">Jornada máxima:</strong> &nbsp;{{usuarioMaquina.horas_maxima_contrato}} Horas / Semana</li>

              <li class="list-group-item border-0 ps-0 pt-0 text-sm"><strong class="text-dark">Huellas registradas:</strong> &nbsp;{{usuarioMaquina.huellas_registradas}} / 3</li>

            </ul>
            <ul class="list-group">

              <li class="list-group-item border-0 px-0">
                <div class="form-check form-switch ps-0">
                  <input class="form-check-input ms-auto" type="checkbox" {% if usuarioMaquina.codigo_fichar == 1 %} checked {% endif %} disabled>                       
                  <div class="form-check form-switch ps-0">
                    <label class="form-check-label text-body ms-3 text-truncate w-80 mb-0" >Puede fichar con PIN</label>
                  </div>                
                </div>
              </li> 

              <li class="list-group-item border-0 px-0">
                <div class="form-check form-switch ps-0">
                  <input class="form-check-input ms-auto" type="checkbox" {% if usuarioMaquina.fichar_remoto == 1 %} checked {% endif %} disabled>                       
                  <div class="form-check form-switch ps-0">
                    <label class="form-check-label text-body ms-3 text-truncate w-80 mb-0" >Puede fichar en remoto</label>
                  </div>                
                </div>
              </li> 
            </ul>
        </div>
      </div>

      <div class="card mt-4">
        <div class="card-header pb-0 p-3">
          <div class="row">
            <div class="col-md-8 d-flex align-items-center">
              <div class="row">
                
                <h5 class="mb-2">
                  Donde puede fichar
                </h5>
                
                <p class="mb-4 text-sm">Maquinas donde el empleado puede registrar la entrada y salida de su jornada laboral.</p>

              </div>
            </div>
          </div>
        </div>
        
        <div class="card-body pt-0 p-3" >
          

          <ul class="list-group">

            <li class="list-group-item border-0 px-0">
              <div class="form-check form-switch ps-0">
                <input class="form-check-input ms-auto" type="checkbox" {% if usuarioMaquina.maquina_laboratorio == 1 %} checked {% endif %} disabled>                       
                <div class="form-check form-switch ps-0">
                  <label class="form-check-label text-body ms-3 text-truncate w-80 mb-0" >Laboratorio</label>
                </div>                
              </div>
            </li> 

            <li class="list-group-item border-0 px-0">
              <div class="form-check form-switch ps-0">
                <input class="form-check-input ms-auto" type="checkbox" {% if usuarioMaquina.maquina_alerta2 == 1 %} checked {% endif %} disabled>                       
                <div class="form-check form-switch ps-0">
                  <label class="form-check-label text-body ms-3 text-truncate w-80 mb-0" >Alerta2</label>
                </div>
              </div>
            </li> 

            <li class="list-group-item border-0 px-0">
              <div class="form-check form-switch ps-0">
                <input class="form-check-input ms-auto" type="checkbox" {% if usuarioMaquina.maquina_departamento == 1 %} checked {% endif %} disabled>
                <div class="form-check form-switch ps-0">
                  <label class="form-check-label text-body ms-3 text-truncate w-80 mb-0" >Departamento</label>
                </div>
              </div>
            </li> 
            
          </ul>
        </div>
      </div>
    </div>
  </div>


  <div id="modalEditarUsuarioMaquina" tabindex="-1" role="dialog" class="modal fade modal-lg" aria-labelledby="modalEditarUsuarioMaquina"
  aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Agregar usuario a la máquina</h5>
          <button type="button" class="close close-modal" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class="modal-body">
        <form id="formularioAgregarUsuarioMaquina" action="{% url 'timetrackpro:ver-usuario-maquina' id=usuarioMaquina.id %}" method="POST"
          enctype="multipart/form-data">
          {% csrf_token %}         
            <div class="row">
              <div class="col-xl-2">
                <label>ID</label>
                <input type="text" class="form-control" placeholder="ID en el dispositivo"
                  aria-label="Nombre en el dispositivo" id="id_empleado_maquina" name="id_empleado_maquina"
                  aria-describedby="text-addon" id="id_empleado_maquina" name="id_empleado_maquina" value="{{usuarioMaquina.id}}">
              </div>
              <div class="col-xl-4">
                <label>Nombre</label>
                <input type="text" class="form-control" placeholder="Nombre en el dispositivo"
                  aria-label="Nombre en el dispositivo" id="nombre_empleado_maquina" name="nombre_empleado_maquina"
                  aria-describedby="text-addon" value="{{usuarioMaquina.nombre}}" >
              </div>
              <div class="col-xl-4">
                <label>¿Empleado en prácticas?</label>
                <div class="form-switch ps-1 my-2">
                  <input class="form-check-input ms-auto" type="checkbox" id="en_practicas" name="en_practicas" {% if  usuarioMaquina.en_practicas == 1 %} checked {% endif %}>
                </div>
              </div>
            </div>
            <div class="row mt-4">
              <div class="col-xl-3">
                <label>Turno</label>
                <select class="form-control" aria-label="Nombre en el dispositivo" id="turno_empleado"
                  name="turno_empleado" aria-describedby="text-addon">
                  <option {% if usuarioMaquina.turno %} value="{{usuarioMaquina.turno}}" {% else %} value="Sin asignar" {% endif %} selected hidden>{% if usuarioMaquina.turno %} {{usuarioMaquina.turno}}{% else %} Sin asignar{% endif %}</option>               
                  <option value="Sin Asignar">Sin Asignar</option>
                  <option value="Mañana">Mañana</option>
                  <option value="Tarde">Tarde</option>
                  <option value="Turno Partido">Turno Partido</option>
                </select>
              </div>
              <div class="col-xl-3">
                <label>Jornada Máxima</label>
                <input class="form-control" type="number" step="0.5" id="jornada_maxima_empleado"
                  name="jornada_maxima_empleado" value="{{usuarioMaquina.horas_maxima_contrato|safe}}" >
              </div>
              
              <div class="col-xl-3">
                <label>Número de huellas</label>
                <input class="form-control" type="number" step="1" min="1" max="3" id="huellas_registradas"
                  name="huellas_registradas" placeholder="máximo 3"  value="{{usuarioMaquina.huellas_registradas}}">
              </div>
            </div>
            <div class="row mt-4">
              <div class="col-xl-12">
                <label class="d-inline">Dispositivos donde puede fichar</label>
                <div class="d-inline form-switch ps-0">
                  <label class="form-check-label text-body ms-3 text-truncate w-80 mb-0 d-inline">Alerta2</label>
                  <input class="form-check-input ms-auto" type="checkbox" id="maquina_alerta2" name="maquina_alerta2" {% if  usuarioMaquina.maquina_alerta2 == 1 %} checked {% endif %}> 
                </div>
                <div class="d-inline form-switch ps-0">
                  <label class="form-check-label text-body ms-3 text-truncate w-80 mb-0 d-inline">Laboratorio</label>
                  <input class="form-check-input ms-auto" type="checkbox" id="maquina_laboratorio" name="maquina_laboratorio" {% if  usuarioMaquina.maquina_laboratorio == 1 %} checked {% endif %}>
                </div>
                <div class="d-inline form-switch ps-0">
                  <label class="form-check-label text-body ms-3 text-truncate w-80 mb-0 d-inline">Departamento</label>

                  <input class="form-check-input ms-auto" type="checkbox" id="maquina_departamento" name="maquina_departamento" {% if  usuarioMaquina.maquina_departamento == 1 %} checked {% endif %}>
                </div>
              </div>
            </div>
            
            <div class="row mt-4">
              <div class="col-xl-6">
                
                <label class="d-inline">Se le permite fichar con PIN</label>
                <div class="d-inline form-switch ps-0">

                  <input class="form-check-input ms-3" type="checkbox" id="permite_pin" name="permite_pin" {% if  usuarioMaquina.codigo_fichar == 1 %} checked {% endif %}> 
                </div>
              </div>
            </div>
            <div class="row mt-4">
              <div class="col-xl-6">
                
                <label class="d-inline">Es administrador del dispositivo</label>
                <div class="d-inline form-switch ps-0">

                  <input class="form-check-input ms-3" type="checkbox" id="es_administrador" name="es_administrador" {% if  usuarioMaquina.admin_dispositivo == 1 %} checked {% endif %}> 
                </div>
              </div>
            </div>
            <div class="row mt-4">
              <div class="col-xl-6">
                
                <label class="d-inline">Puede fichar en remoto</label>
                <div class="d-inline form-switch ps-0">

                  <input class="form-check-input ms-3" type="checkbox" id="fichar_remoto" name="fichar_remoto" {% if  usuarioMaquina.fichar_remoto == 1 %} checked {% endif %}> 
                </div>
              </div>
            </div>
        </div>
        <div class="modal-footer">
          {% if user.is_authenticated  %}
          <button type="submit" value="submit"  class="btn btn-primary">Guardar</button>
          {% endif %}
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        </div>
      </form>
      </div>
    </div>
  </div>

{% endblock %}

{% extends "base/base_timetrackpro.html" %}
{% load static %}
{% block imports %}
{% endblock %}
{% block content %}

  <div class="page-header min-vh-75">
    <div class="container filaForm">
      <div class="row">
        <div class="col-lg-8">
          <div class="card card-plain">
            <div class="card-header pb-0 text-left bg-transparent">
              <h3 class="font-weight-bolder text-info text-gradient">Registrar un permiso</h3>
              <p class="mb-0">Introduce la información del permiso</p>
            </div>
            <div class="card-body">
              <form action="{% url 'timetrackpro:agregar-permiso' %}" method="POST" enctype="multipart/form-data">
              {% csrf_token %}

                <div class="row">
                  <div class="col-xl-4">
                    <label>Nombre</label>
                    <div class="mb-3">
                      <input type="text" class="form-control" placeholder="Nombre en el dispositivo" aria-label="Nombre en el dispositivo" id="nombre_permiso" name="nombre_permiso" aria-describedby="text-addon">
                    </div>
                  </div>
                  <div class="col-xl-2">
                    <label>Duración en días</label>
                    <div class="mb-3">
                      <input type="number" class="form-control" placeholder="3" aria-label="Duración del permiso" id="duracion_permiso" name="duracion_permiso" min="1" aria-describedby="text-addon">
                    </div>
                  </div>
                  <div class="col-xl-3">
                    <label>Tipo de días</label>
                    <div class="mb-3">
                      <select class="form-control" aria-label="Nombre en el dispositivo" id="tipo_dias"
                      name="tipo_dias" aria-describedby="text-addon">
                      <option value="Naturales">Naturales</option>
                      <option value="Hábiles" selected>Hábiles</option>
                    </select>
                    </div>
                  </div>
                  <div class="col-xl-3">
                    <label>Fecha límite para la solicitud</label>
                    <div class="mb-3">
                      <input type="date" class="form-control" aria-label="Nombre en el dispositivo"
                        aria-describedby="text-addon" name="fecha_limite_solicitud" id="fecha_limite_solicitud">
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-6">
                    <label>Periodo de antelación</label>
                    <div class="mb-3">
                      <textarea type="text" class="form-control" placeholder="Indique con palabras el perido con el que se puede solicitar" aria-label="Información sobre el periodo de antelación" id="periodo_antelacion" name="periodo_antelacion" aria-describedby="text-addon"></textarea>
                    </div>
                  </div>
                  <div class="col-xl-6">
                    <label>Documentación a aportar</label>
                    <div class="mb-3">
                      <textarea type="text" class="form-control" placeholder="Documentación que debe aportar para justificar el permiso" aria-label="Documentación justificativa" id="documentacion_permiso" name="documentacion_permiso" aria-describedby="text-addon"></textarea>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-xl-9">
                    <label>Legislación aplicable</label>
                    <div class="mb-3">
                      <textarea type="text" class="form-control" placeholder="Legislación en la que se recoge el derecho a este permiso" aria-label="Legislacion aplicable al permiso" id="legilacion_aplicable" name="legilacion_aplicable" aria-describedby="text-addon"></textarea>
                    </div>
                  </div>
                                
                  <div class="col-xl-3">
                    <label>¿Quién se beneficia?</label>
                    <div class="mb-3">
                      <div class="form-switch ps-1 my-2">
                        <label >PAS</label>

                        <input class="form-check-input ms-auto" type="checkbox" id="pas" name="pas">
                        <label class="text-muted">Si</label>
                      </div>
                      <div class="form-switch ps-1 my-2">
                        <label >PDI</label>
                        <input class="form-check-input ms-auto" type="checkbox" id="pdi" name="pdi">
                        <label class="text-muted">Si</label>
                      </div>
                    </div>
                  </div>
                  
                </div>
                <div class="row">
                  <div class="col-xl-4">
                    <label>Bonificable por antigüedad</label>
                    <div class="mb-3">
                      <div class="form-switch ps-1 my-2">

                        <input class="form-check-input ms-auto" type="checkbox" id="bonificable" name="bonificable">
                        <label class="text-muted">Si</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-xl-4">
                    <label>¿Es un permiso retribuido?</label>
                    <div class="mb-3">
                      <div class="form-switch ps-1 my-2">

                        <input class="form-check-input ms-auto" type="checkbox" id="retribuido" name="retribuido">
                        <label class="text-muted">Si</label>
                      </div>
                    </div>
                  </div>                  
                  <div class="col-xl-4">
                    <label>¿Se debe acreditar?</label>
                    <div class="mb-3">
                      <div class="form-switch ps-1 my-2">

                        <input class="form-check-input ms-auto" type="checkbox" id="acreditable" name="acreditable">
                        <label class="text-muted">Si</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-xl-4" hidden>
                    <label>Año al que aplica</label>
                    <div class="mb-3">
                      <input type="number" class="form-control" placeholder="2023" min="2022" max="2050" id="year_permiso" name="year_permiso" aria-label="Año al que aplica"  value="2023" aria-describedby="text-addon">
                    </div>
                  </div>    
                </div>
                <div class="row" id="bonificaciones" hidden>
                  <div class="col-xl-3">
                    <label>Por 15 años</label>
                    <div class="mb-3">
                      <input type="number" class="form-control" placeholder="1" min="0" max="2" id="bonificacion_15_year" value="0" name="bonificacion_15_year" aria-label="Año al que aplica" aria-describedby="text-addon">
                    </div>
                  </div>                  
                  <div class="col-xl-3">
                    <label>Por 20 años</label>
                    <div class="mb-3">
                      <input type="number" class="form-control" placeholder="1" min="0" max="2" id="bonificacion_20_year" value="0" name="bonificacion_20_year"  aria-label="Año al que aplica" aria-describedby="text-addon">
                    </div>
                  </div>                
                  <div class="col-xl-3">
                    <label>Por 25 años</label>
                    <div class="mb-3">
                      <input type="number" class="form-control" placeholder="1" min="0" max="2" id="bonificacion_25_year" value="0" name="bonificacion_25_year" aria-label="Año al que aplica" aria-describedby="text-addon">
                    </div>
                  </div>                
                  <div class="col-xl-3">
                    <label>Por 30 años</label>
                    <div class="mb-3">
                      <input type="number" class="form-control" placeholder="1" min="0" max="2" id="bonificacion_30_year" value="0" name="bonificacion_30_year" aria-label="Año al que aplica" aria-describedby="text-addon">
                    </div>
                  </div>
                </div>
                <div class="text-center">
                  <button type="submit" value="submit" class="btn bg-gradient-info w-100 mt-4 mb-0">Guardar</button>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="col-md-4" >
          <div class="oblique position-absolute top-0 h-100 d-lg-block d-none me-n8">
            <div class="oblique-image bg-cover position-absolute fixed-top ms-auto h-100 z-index-0 ms-n6 background-timetrackpro-c6">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  
<script>
  // oculta y muestra el formulario de bonificaciones
  $(document).ready(function(){
    $("#bonificable").click(function(){
      if ($("#bonificable").is(':checked')) {
        $("#bonificacion_15_year").val(1);
        $("#bonificacion_20_year").val(1);
        $("#bonificacion_25_year").val(1);
        $("#bonificacion_30_year").val(1);

        $("#bonificacion_15_year").attr("required", true);
        $("#bonificacion_20_year").attr("required", true);
        $("#bonificacion_25_year").attr("required", true);
        $("#bonificacion_30_year").attr("required", true);

        $("#bonificaciones").removeAttr("hidden");

      } else {
        $("#bonificacion_15_year").val(0);
        $("#bonificacion_20_year").val(0);
        $("#bonificacion_25_year").val(0);
        $("#bonificacion_30_year").val(0);

        $("#bonificacion_15_year").attr("required", false);
        $("#bonificacion_20_year").attr("required", false);
        $("#bonificacion_25_year").attr("required", false);
        $("#bonificacion_30_year").attr("required", false);

        $("#bonificaciones").attr("hidden", true);

      }
    });
  });

  // actualizar el valor del año en el formulario por el año actual si la fecha límite esta vacia, de lo contrario poner el año de la fecha límite
  $(document).ready(function(){
    $("#fecha_limite_solicitud").change(function(){
      if ($("#fecha_limite_solicitud").val() == "") {
        var d = new Date();
        var n = d.getFullYear();
        $("#year_permiso").val(n);
      } else {
        var d = new Date($("#fecha_limite_solicitud").val());
        var n = d.getFullYear();
        $("#year_permiso").val(n);
      }
    });
  });

  

</script>

{% endblock %}